<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Build-a-Yeast · Pseudoseq.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.png" alt="Pseudoseq.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Pseudoseq.jl</span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../puzzlemaker/concepts/">PuzzleMaker</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Sequencing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sequencing/concepts/">Core concepts &amp; workflow</a></li><li><input class="collapse-toggle" id="menuitem-2-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sequencing/examples/pe-example/">Paired end reads</a></li><li><a class="tocitem" href="../../../sequencing/examples/se-example/">Long single end reads</a></li><li><a class="tocitem" href="../../../sequencing/examples/tg-example/">Tagged paired end reads</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Build-a-Genome</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../concepts/">Core concepts &amp; workflow</a></li><li><input class="collapse-toggle" id="menuitem-2-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Build-a-Yeast</a><ul class="internal"><li><a class="tocitem" href="#Load-the-seed-sequence-1"><span>Load the seed sequence</span></a></li><li><a class="tocitem" href="#Designing-a-diploid-1"><span>Designing a diploid</span></a></li><li><a class="tocitem" href="#Designing-a-triploid-1"><span>Designing a triploid</span></a></li><li><a class="tocitem" href="#Designing-a-tetraploid-genome-1"><span>Designing a tetraploid genome</span></a></li></ul></li></ul></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Sequencing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../api/sequence/">sequence</a></li><li><a class="tocitem" href="../../../../api/pool/">Molecule Pool</a></li><li><a class="tocitem" href="../../../../api/reads/">Reads</a></li></ul></li><li><a class="tocitem" href="../../../../api/chromosome-blueprint/">Build-a-Genome</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">Build-a-Genome</a></li><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Build-a-Yeast</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Build-a-Yeast</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/master/examples/build-a-genome/build-a-yeast.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Build-a-Yeast-1"><a class="docs-heading-anchor" href="#Example:-Build-a-Yeast-1">Example: Build-a-Yeast</a><a class="docs-heading-anchor-permalink" href="#Example:-Build-a-Yeast-1" title="Permalink"></a></h1><p>This is an example generated from this source file: <a href="https://github.com/bioinfologics/Pseudoseq.jl/blob/masterexamples/build-a-genome/build-a-yeast.jl"><code>build-a-yeast.jl</code></a> You are seeing the online documentation version. The corresponding notebook can be found here: <a href="https://nbviewer.jupyter.org/github/bioinfologics/Pseudoseq.jl/blob/gh-pages/previews/PR10examples/build-a-genome/build-a-yeast.ipynb"><code>build-a-yeast.ipynb</code></a> and the script can be found here: <a href="../build-a-yeast.jl"><code>build-a-yeast.jl</code></a></p><p>We are going to use Pseudoseq to create a simple set of fake genomes, based on chromosome 1 of the reference genome for yeast.</p><ol><li>Load the sequence of chromosome 1 of the yeast reference from FASTA file.</li><li>Create blank chromosome blueprints for different genome designs.</li><li>Edit the blueprints to achive a: a. Diploid chromosome b. Triploid chromosome c. Tetraploid chromosome</li></ol><pre><code class="language-julia">using FASTX, BioSequences, Pseudoseq</code></pre><h2 id="Load-the-seed-sequence-1"><a class="docs-heading-anchor" href="#Load-the-seed-sequence-1">Load the seed sequence</a><a class="docs-heading-anchor-permalink" href="#Load-the-seed-sequence-1" title="Permalink"></a></h2><p>First load the sequence from FASTA file. This uses tools from FASTX, which is a dependency of Pseudoseq and so the user should have it available, as julia&#39;s package manager would have installed any dependencies. The lines below open a fasta file, with a fasta reader, and load a single FASTA record, and get its sequence.</p><pre><code class="language-julia">refseq = open(FASTA.Reader, &quot;yeast-chr1.fasta&quot;) do rdr
    FASTA.sequence(LongSequence{DNAAlphabet{2}}, read(rdr))
end

reflen = length(refseq)</code></pre><pre><code class="language-none">230218</code></pre><p>This results in a 230,218nt long sequence called <code>refseq</code>.</p><h2 id="Designing-a-diploid-1"><a class="docs-heading-anchor" href="#Designing-a-diploid-1">Designing a diploid</a><a class="docs-heading-anchor-permalink" href="#Designing-a-diploid-1" title="Permalink"></a></h2><p>First lets make a plan for a diploid genome with 1% heterozygosity. Pseudoseq has a lot of flexibilty in how you can define the heterozygosity, but for ease here I&#39;m going to let it decide where the sites should be, and what the alleles at each site should be, by calling <a href="../../../../api/chromosome-blueprint/#Pseudoseq.plan_het"><code>plan_het</code></a>, providing just the proportion of sites I want to be heterozygous, and the number of alleles I want at each of these heterozygous sites (2).</p><pre><code class="language-julia">dploid = plan_chrom(reflen, 2)
dploidhet = plan_het(dploid, .01, 2)</code></pre><pre><code class="language-none">Specification for a chromosome:
 Number of copies: 2
 Length of chromosomes: 230218
 227916bp available in the following stretches:
</code></pre><p>Now fabricate the FASTA, with <a href="../../../../api/chromosome-blueprint/#Pseudoseq.fabricate"><code>fabricate</code></a>, providing a filename, and then a series of <code>blueprint =&gt; seed</code> pairs. In this case we just give 1 blueprint-seed</p><pre><code class="language-julia"># pair.

fabricate(&quot;build-a-yeast-di.fasta&quot;, dploidhet =&gt; refseq)</code></pre><pre><code class="language-none">[ Info: Opening FASTA file at: build-a-yeast-di.fasta
[ Info: Fabricated 1 chromosomes and written to file</code></pre><p>Thats it for the diploid genome.</p><h2 id="Designing-a-triploid-1"><a class="docs-heading-anchor" href="#Designing-a-triploid-1">Designing a triploid</a><a class="docs-heading-anchor-permalink" href="#Designing-a-triploid-1" title="Permalink"></a></h2><p>Now let&#39;s make a triploid genome. This should also be simple enough. It&#39;s much like the process for making the diploid genome, but specifying 3 chromosome copies instead of 2.</p><pre><code class="language-julia">trploid = plan_chrom(reflen, 3)</code></pre><pre><code class="language-none">Specification for a chromosome:
 Number of copies: 3
 Length of chromosomes: 230218
 230218bp available in the following stretches:
</code></pre><p>When I add some heterozygous sites, just like with the diploid case, I&#39;m going to simply ask for a proportion of heterozygous sites (and let Pseudoseq decide where they should occur. Like last time also I&#39;m going to make all the sites have 2 alleles, so for every heterozygous site, two of the three chromosome copies willl have the same base, and one of the copies will be different. There are other ways to define some heterozygous sites for example all 3 chromosome copies could have different bases</p><pre><code class="language-julia">trploidhet = plan_het(trploid, .01, 2)</code></pre><pre><code class="language-none">Specification for a chromosome:
 Number of copies: 3
 Length of chromosomes: 230218
 227916bp available in the following stretches:
</code></pre><p>Now fabricate the FASTA, with <code>fabricate</code>, providing a filename, and then a series of <code>blueprint =&gt; seed</code> pairs. In this case we just give 1 blueprint-seed</p><pre><code class="language-julia"># pair.

fabricate(&quot;build-a-yeast-tri.fasta&quot;, trploidhet =&gt; refseq)</code></pre><pre><code class="language-none">[ Info: Opening FASTA file at: build-a-yeast-tri.fasta
[ Info: Fabricated 1 chromosomes and written to file</code></pre><p>That&#39;s it for the triploid genome.</p><h2 id="Designing-a-tetraploid-genome-1"><a class="docs-heading-anchor" href="#Designing-a-tetraploid-genome-1">Designing a tetraploid genome</a><a class="docs-heading-anchor-permalink" href="#Designing-a-tetraploid-genome-1" title="Permalink"></a></h2><p>Lets make a tetraploid genome, that consists of two diploid genomes, an A genome and a B genome. First I&#39;m going to create a chromosome blueprint with 4 copies:</p><pre><code class="language-julia">tetploid = plan_chrom(reflen, 4)</code></pre><pre><code class="language-none">Specification for a chromosome:
 Number of copies: 4
 Length of chromosomes: 230218
 230218bp available in the following stretches:
</code></pre><p>We want to plan the heterozygosity in this tetraploid such that the number of heterozygous sites within the A and B genomes is ~1%. But we want ~3% of sites to be heterozygous between the A and B genomes.</p><p>First we will say copies 1 + 2 in our blueprint are the A genome, and copies 3 + 4 are the B genome. Next consider heterozygous sites with 2 different alleles, A and B, 6 different patterns are possible:</p><table><tr><th style="text-align: center">Copy 1</th><th style="text-align: center">Copy 2</th><th style="text-align: center">Copy 3</th><th style="text-align: center">Copy 4</th></tr><tr><td style="text-align: center">A</td><td style="text-align: center">A</td><td style="text-align: center">B</td><td style="text-align: center">B</td></tr><tr><td style="text-align: center">B</td><td style="text-align: center">B</td><td style="text-align: center">A</td><td style="text-align: center">A</td></tr><tr><td style="text-align: center">A</td><td style="text-align: center">B</td><td style="text-align: center">A</td><td style="text-align: center">B</td></tr><tr><td style="text-align: center">B</td><td style="text-align: center">A</td><td style="text-align: center">B</td><td style="text-align: center">A</td></tr><tr><td style="text-align: center">A</td><td style="text-align: center">B</td><td style="text-align: center">B</td><td style="text-align: center">A</td></tr><tr><td style="text-align: center">B</td><td style="text-align: center">A</td><td style="text-align: center">A</td><td style="text-align: center">B</td></tr></table><p>The first 2 patterns in the table constitute fixed mutations between genomes A and B, but not polymorphism within genomes A and B. This is because Copy 1 and 3 differ, as do copies 2 and 4, yet copies 1 and 2 are the same, as are copies 3 and 4. To achieve a ~3% divergence between genomes A and B, let&#39;s plan some divergent mutations by grouping the copy numbers together when planning some heterozygous sites:</p><pre><code class="language-julia">thet = plan_het(tetploid, .03, [1, 2], [3, 4])</code></pre><pre><code class="language-none">Specification for a chromosome:
 Number of copies: 4
 Length of chromosomes: 230218
 223312bp available in the following stretches:
</code></pre><p>By using the groups <code>[1, 2]</code> and <code>[3, 4]</code> we ensure chromosome copy 1 and 2 will have the same allele, as will chromosomes 3 and 4</p><p>Next we&#39;ll just add some of the other heterozygosity patterns to achieve the 1% internal heterozygosity desired. We&#39;ll use a heterozygosity pattern with two states.</p><pre><code class="language-julia">thet = plan_het(thet, .01, [1, 3], [2, 4])

fabricate(&quot;build-a-yeast-tet.fasta&quot;, thet =&gt; refseq)</code></pre><pre><code class="language-none">[ Info: Opening FASTA file at: build-a-yeast-tet.fasta
[ Info: Fabricated 1 chromosomes and written to file</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../concepts/">« Core concepts &amp; workflow</a><a class="docs-footer-nextpage" href="../../../../api/sequence/">sequence »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 23 January 2020 16:32">Thursday 23 January 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
