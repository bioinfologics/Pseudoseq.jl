<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Build-a-Genome: Core concepts &amp; basic workflow · Pseudoseq.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Pseudoseq.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Pseudoseq.jl</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../puzzlemaker/concepts/">PuzzleMaker</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Sequencing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../sequencing/concepts/">Core concepts &amp; workflow</a></li><li><input class="collapse-toggle" id="menuitem-2-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../sequencing/examples/pe-example/">Paired end reads</a></li><li><a class="tocitem" href="../../sequencing/examples/se-example/">Long single end reads</a></li><li><a class="tocitem" href="../../sequencing/examples/tg-example/">Tagged paired end reads</a></li></ul></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Sequencing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/sequence/">sequence</a></li><li><a class="tocitem" href="../../../api/pool/">Molecule Pool</a></li><li><a class="tocitem" href="../../../api/reads/">Reads</a></li></ul></li><li><a class="tocitem" href="../../../api/chromosome-blueprint/">Build-a-Genome</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Build-a-Genome: <em>Core concepts &amp; basic workflow</em></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Build-a-Genome: <em>Core concepts &amp; basic workflow</em></a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/master/docs/src/man/build-a-genome/concepts.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Build-a-Genome:-*Core-concepts-and-basic-workflow*-1"><a class="docs-heading-anchor" href="#Build-a-Genome:-*Core-concepts-and-basic-workflow*-1">Build-a-Genome: <em>Core concepts &amp; basic workflow</em></a><a class="docs-heading-anchor-permalink" href="#Build-a-Genome:-*Core-concepts-and-basic-workflow*-1" title="Permalink"></a></h1><p><code>Pseudoseq</code> allows you to plan and build genomes and chromosomes that have a certain set of features and peculiarities. The purpose for doing this is not to recreate biology perfectly. The purpose is to create genomes you understand fully (where the repeated content is, which positions are heterozygous and so on).</p><p>Using such genomes can help you both understand and develop an intuition of what current genome assembly tools are doing, and also to help design assembly tools, and perhaps even plan sequencing experiments and form hypotheses.</p><p>This manual includes several examples showing how to plan genomes with certain characteristics. But the core workflow, and important concepts are explained below, in 3 steps.</p><h2 id=".-Creating-chromosome-blueprints-1"><a class="docs-heading-anchor" href="#.-Creating-chromosome-blueprints-1">1. Creating chromosome blueprints</a><a class="docs-heading-anchor-permalink" href="#.-Creating-chromosome-blueprints-1" title="Permalink"></a></h2><p>Chromosome blueprints are the backbone of simulating genomes with Pseudoseq.</p><p>Chromosome blueprints determine the nature of one chromosome in a genome.</p><p>You can think of chromosome blueprints in Pseudoseq as: <em>a collection of operations which, when applied to some seed sequence, result in a set of N homologous sequences</em>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Chromosome blueprints are <em>immutable</em>: Adding an operation to a chromosome blueprint creates a new blueprint, which is a copy of the old blueprint with the addition of the new operation.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Ideally, for any chromosome blueprint you construct with Pseudoseq, for each operation is possesses, it must be possible (at least in principle) to be able to intuit what the effect of that operation will be on:</p><ol><li>The Khmer distribution produced by sequencing reads of the fabricated chromosome.</li><li>The structure of a sequence graph produced by sequencing reads of the fabricated chromosome.</li></ol><p>Therefore, we have made the design decision that <em>no two operations in a chromosome blueprint may affect the same position(s) of the genome in a conflicting manner.</em> To meet this requirement, certain operations &quot;consume&quot; a region of the chromosome planned in a blueprint. If a region is consumed, another operation that would also affect that region cannot be added to the blueprint.</p></div></div><p>Depending on the genome, any given chromosome may be present in multiple copies. Diploids, for example have two copies of every chromosome.</p><p>The first step in simulating any artificial genome is to create one or more blank chromosome blueprints. The <a href="man/build-a-genome/@ref"><code>plan_chrom</code></a> function is used for this.</p><p>For example, this:</p><pre><code class="language-julia-repl">julia&gt; using Pseudoseq

julia&gt; c = plan_chrom(100, 2)
ERROR: UndefVarError: plan_chrom not defined</code></pre><p>will create a blank blueprint for 2 copies of a chromosome of 100bp length. From the output you can see that it prints for you the number of chromosome copies, the length of the chromosomes, and a list of available, <em>unconsumed</em> regions of the chromosome (see note above).</p><h2 id=".-Adding-planned-features-to-a-chromosome-blueprint-1"><a class="docs-heading-anchor" href="#.-Adding-planned-features-to-a-chromosome-blueprint-1">2. Adding planned features to a chromosome blueprint</a><a class="docs-heading-anchor-permalink" href="#.-Adding-planned-features-to-a-chromosome-blueprint-1" title="Permalink"></a></h2><p>After creating a fresh chromosome blueprint, no plans (operations) have been added yet.</p><p>If you were to <a href="man/build-a-genome/@ref"><code>fabricate</code></a> this blank blueprint, you would get <code>N</code> identical DNA sequences as output, where <code>N</code> is the number of copies the blueprint was planning.</p><p>Once you have one or more chromosome blueprints, you can add features to them.</p><p>This is done with a series of consistently named <code>plan_*</code> functions.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Remember; blueprints are immutable, so every time one of these <code>plan_*</code> functions is used to add a feature to a chromosome blueprint, a new chromosome blueprint is created.</p></div></div><h3 id="Repetitions-1"><a class="docs-heading-anchor" href="#Repetitions-1">Repetitions</a><a class="docs-heading-anchor-permalink" href="#Repetitions-1" title="Permalink"></a></h3><p>A repetition is a segment of a sequence, that has the exact same motif, as  another segment of the sequence.</p><p>In Pseudoseq, to plan a repetition, you specify a region the repetition will copy, sometimes called the <code>from</code> region. You also specify a region where the motif in the <code>from</code> region will be replicated, called the <code>to</code> region. So you might find it helpful to imagine a planned repetition as a kind of copy-paste operation that occurs during <a href="man/build-a-genome/@ref"><code>fabricate</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Repetitions consume the <code>to</code> region of the chromosome blueprint to which they are added. Repetitions <em>do not</em> consume the <code>from</code> region, so other operations are free to affect the motif in the <code>from</code> region. Just remember that the repetition will replicate anything in the <code>from</code> region, including other features such as heterozygosity that occur in <code>from</code>.</p></div></div><p>Repetitions are added to a genome blueprint using the <a href="man/build-a-genome/@ref"><code>plan_repetition</code></a> function.</p><h3 id="Heterozygosity-1"><a class="docs-heading-anchor" href="#Heterozygosity-1">Heterozygosity</a><a class="docs-heading-anchor-permalink" href="#Heterozygosity-1" title="Permalink"></a></h3><p>A heterozygosity describes a base position at which the copies of the chromosome in the blueprint differ.</p><p>For a blueprint with 2 copies, both copies will differ at a given position.</p><p>For a triploid, at a heterozygous position, all 3 copies might differ from each other. Alternatively, it is possible that 2 copies are the same, but they differ from a 3rd copy. This applies for blueprints with higher copy numbers too: at a heterozygous position some copies will differ from each other at that position, but some of the copies might be the same.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Heterozygosity operations consume the position at which they are defined.</p></div></div><p>Heterozygous positions are planned using the <a href="man/build-a-genome/@ref"><code>plan_het</code></a> function.</p><p>For example, below will make it so as about 50% of the two chromosome copies  are heterozygous:</p><pre><code class="language-julia-repl">julia&gt; using Pseudoseq

julia&gt; c = plan_chrom(100, 2)
ERROR: UndefVarError: plan_chrom not defined

julia&gt; chet = plan_het(c, .50, 2)
ERROR: UndefVarError: plan_het not defined</code></pre><p>The above use of <a href="man/build-a-genome/@ref"><code>plan_het</code></a> allows the function to choose which sites in the blueprint are heterozygous, and how to allocate the bases at the heterozygous sites. We only instruct the function that 50% of the genome should be heterozygous, and that there should be 2 possible bases at each position (the only option really: the blueprint plans for a diploid - 2 chromosome copies).</p><p>You can also take more fine-grained control:</p><pre><code class="language-julia-repl">julia&gt; using Pseudoseq, BioSequences

julia&gt; c = plan_chrom(100, 2)
ERROR: UndefVarError: plan_chrom not defined

julia&gt; chet = plan_het(c, 20, [DNA_T, DNA_A])
ERROR: UndefVarError: plan_het not defined</code></pre><p>Here I planned a heterozygous position, at one site in the chromosome (20), and I set the state of the first copy to <code>DNA_T</code>, and the state of the second copy to <code>DNA_A</code>.</p><p>So as you can see, <a href="man/build-a-genome/@ref"><code>plan_het</code></a> is very flexible. Check it&#39;s API documentation, and the &quot;Build-A-Yeast&quot; example walkthrough to see more examples of <a href="man/build-a-genome/@ref"><code>plan_het</code></a> use.</p><h3 id="Utility-functions-1"><a class="docs-heading-anchor" href="#Utility-functions-1">Utility functions</a><a class="docs-heading-anchor-permalink" href="#Utility-functions-1" title="Permalink"></a></h3><p>There is a utility function <a href="man/build-a-genome/@ref"><code>suggest_regions</code></a> available to help you plan where to place features.</p><p>Say you wanted to see where you could place 3 5bp repetitions, you could do the following:</p><pre><code class="language-julia-repl">julia&gt; r = suggest_regions(chet, 5, 6)
ERROR: UndefVarError: suggest_regions not defined</code></pre><p>So now you have 6 5bp regions, every 2 regions defining a <code>from</code> and a <code>to</code> region for a single repetition. </p><p>You can provide <code>r</code> as an input to <a href="man/build-a-genome/@ref"><code>plan_repetition</code></a>.</p><pre><code class="language-julia-repl">julia&gt; crep = plan_repetition(chet, r)
ERROR: UndefVarError: plan_repetition not defined</code></pre><p>Another utility function <a href="man/build-a-genome/@ref"><code>suggest_alleles</code></a> is available to help you plan nucleotide patterns at heterozygous sites.</p><p>Say you wanted to plan a pattern in which two of three chromosome copies had the same base, and a third differed.</p><pre><code class="language-julia-repl">julia&gt; suggest_alleles(3, 2)
ERROR: UndefVarError: suggest_alleles not defined</code></pre><p>The above asks for an allele pattern for 3 copies of a chromosome, with 2 possible alleles, which chromosome copy gets which allele is random.</p><p>You can also take more control and specify which chromosome copy gets which state:</p><pre><code class="language-julia-repl">julia&gt; suggest_alleles(chet, [1, 1, 2])
ERROR: UndefVarError: suggest_alleles not defined

julia&gt; # Or alternatively put:
       suggest_alleles(chet, [1, 2], [3])
ERROR: UndefVarError: suggest_alleles not defined</code></pre><p>In the above, which chromosomes get the same allele is user-specified, but which bases those alleles are, is randomly determined.</p><p>You can get many suggestions at once:</p><pre><code class="language-julia-repl">julia&gt; suggest_alleles(5, [1, 1, 2])
ERROR: UndefVarError: suggest_alleles not defined</code></pre><p>See the API docs for <a href="man/build-a-genome/@ref"><code>suggest_alleles</code></a> for more details on the arguments permitted by the different methods. </p><h2 id=".-Fabricate-a-FASTA-from-chromosome-blueprints-1"><a class="docs-heading-anchor" href="#.-Fabricate-a-FASTA-from-chromosome-blueprints-1">3. Fabricate a FASTA from chromosome blueprints</a><a class="docs-heading-anchor-permalink" href="#.-Fabricate-a-FASTA-from-chromosome-blueprints-1" title="Permalink"></a></h2><p>Once you have a set of chromosome blueprints with the features planned that you desire, you can fabricate the sequences of these chromosomes.</p><p>To do that, use the <a href="man/build-a-genome/@ref"><code>fabricate</code></a> method.</p><p>You can simply fabricate the sequences, for use in the interactive session:</p><pre><code class="language-julia-repl">julia&gt; fabricate(chet)
ERROR: UndefVarError: fabricate not defined</code></pre><p>Or have the sequences output to a FASTA formatted file.</p><pre><code class="language-julia-repl">julia&gt; fabricate(&quot;mychrom.fasta&quot;, chet)
ERROR: UndefVarError: fabricate not defined</code></pre><p>A randomly generated seed sequence is used to start the fabrication process unless you provide one. See the API docs for <a href="man/build-a-genome/@ref"><code>fabricate</code></a> for more details.</p><p>And that&#39;s all there is to building a chromosome with Pseudoseq. To build a genome with more than one chromosome, simply build a set of chromosome blueprints.</p><p>Now check out the examples to see how various genomes can be built with Pseudoseq.</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 18 May 2020 09:46">Monday 18 May 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
