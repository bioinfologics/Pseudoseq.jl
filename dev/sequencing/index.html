<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Core concepts &amp; workflow · Pseudoseq.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Pseudoseq.jl logo"/></a><h1>Pseudoseq.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Build-a-Genome</span><ul><li><a class="toctext" href="../build-a-genome/">Core concepts &amp; workflow</a></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../examples/build-a-yeast/">Build-a-Yeast</a></li></ul></li></ul></li><li><span class="toctext">Sequencing</span><ul><li class="current"><a class="toctext" href>Core concepts &amp; workflow</a><ul class="internal"></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../examples/pe-example/">Paired end reads</a></li><li><a class="toctext" href="../examples/se-example/">Long single end reads</a></li><li><a class="toctext" href="../examples/tg-example/">Tagged paired end reads</a></li></ul></li></ul></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="../api/sequence/">Sequencing</a></li><li><a class="toctext" href="../api/pool/">Molecule Pool</a></li><li><a class="toctext" href="../api/reads/">Reads</a></li><li><a class="toctext" href="../api/chromosome-blueprint/">Chromosome Blueprint</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Sequencing</li><li><a href>Core concepts &amp; workflow</a></li></ul><a class="edit-page" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/master/docs/src/sequencing.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Core concepts &amp; workflow</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Sequencing:-*Core-concepts-and-basic-workflow*-1" href="#Sequencing:-*Core-concepts-and-basic-workflow*-1">Sequencing: <em>Core concepts &amp; basic workflow</em></a></h1><p><code>Pseudoseq</code> abstracts DNA sequencing experiments as sampling processes, because this is what they are from a statistical point of view. Just as a quadrat placed at random on the forest floor provides a small sample of it&#39;s species composition, so it is that a sequencing read provides a small sample of the composition of the motifs present in a genome.</p><p>This manual includes several examples showing how to emulate various sequencing experiments using different technologies. But the core workflow, and important concepts are outlined below.</p><div class="admonition tip"><div class="admonition-title">Tip</div><div class="admonition-text"><p>The user can use Pseudoseq&#39;s API to script each stage of the flow outlined below themselves, or they can use the <a href="../api/sequence/#Pseudoseq.sequence"><code>sequence</code></a> function, which is the highest-level user facing function. Every example in this section of the manual, will show you how to use both options to achieve the same goal.</p></div></div><p>Anyway, the core sequencing workflow in Pseudoseq is as follows...</p><h3><a class="nav-anchor" id=".-Create-a-pool-of-DNA-molecules-1" href="#.-Create-a-pool-of-DNA-molecules-1">1. Create a pool of DNA molecules</a></h3><p>In reality, all DNA sequencing experiments begin with a sample of tissue or cells. DNA is extracted from the sample in the laboratory, after the genomes of the cells exist as number of DNA molecules, suspended in a solution.</p><p>In <code>Pseudoseq</code>, such a collection of DNA molecules is called <em>the molecule pool</em>, it is created with the <a href="../api/pool/#Pseudoseq.makepool"><code>makepool</code></a> function.</p><p>In the beginning of a <code>Psueodseq</code> simulation script you create a pool that is the totality of all copies of the genome that exist in your simulation.</p><div class="admonition tip"><div class="admonition-title">Tip</div><div class="admonition-text"><p>You can think of the pool at this stage as containing many copies of the same genome sequence:</p><pre><code class="language-none">   1. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
   2. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
   3. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
                                ...
4999. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
5000. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC</code></pre></div></div><h3><a class="nav-anchor" id=".-Process-the-DNA-molecule-pool-1" href="#.-Process-the-DNA-molecule-pool-1">2. Process the DNA molecule pool</a></h3><p>You then subject your starting DNA molecule pool to a series of transformations, until the pool has the properties you want to emulate.</p><p>Here we will describe the different transformations you can apply to a DNA molecule pool:</p><h4><a class="nav-anchor" id="Fragmenting-the-pool-1" href="#Fragmenting-the-pool-1">Fragmenting the pool</a></h4><p>In an ideal world, if DNA sequencing machines could start at one end of a molecule and read the sequence all the way to the end with reasonable accuracy and throughput, you could simulate that by selecting molecules from your pool, and producing a read file. Give or take some inevitable errors (all detection equipment has a rate of error), assembling a genome would be simple.</p><p>Sadly, we don&#39;t have such an amazing sequencer technology that allows the reading of a chromosome in its entirety. Instead, shorter reads are taken of short fragments of DNA. Even long read technology uses fragments and produces reads, much shorter than the full size of a chromosome molecule.</p><p>A common step in any DNA sequencing experiment, therefore, is to fragment or shear the DNA molecules that are present in the pool.</p><p>This is achieved in <code>Pseudoseq</code> with the <a href="../api/pool/#Pseudoseq.fragment-Tuple{Pseudoseq.MoleculePool,Int64}"><code>fragment</code></a> function.</p><div class="admonition tip"><div class="admonition-title">Tip</div><div class="admonition-text"><p>You can visualise this process like so:</p><p>From:</p><pre><code class="language-none">   1. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
   2. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
   3. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
                                ...
4999. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC
5000. CGGACTTGAATAGCCCAAAGGTTTCGACACGATCACGACACATAAATTGGCGGACTTGAATAGC</code></pre><p>To:</p><pre><code class="language-none">   1. CGGACTT GAATAGC CCAAA GGTTTCGACACGA TCACGAC ACATAAAT TGGCGGAC TTGAATAGC
   2. CGGA CTTGAAT AGCCCAAAG GTTTCGAC ACGATCACGACACAT AAATTGGCGGA CTTGA ATAGC
   3. CGGACTTGA ATAGCC CAAAGGT TTCGACACGAT CACGACACA TAAATT GGCGGACTT GAATAGC
                                ...
4999. CGGAC TTGAATA GCCCAAAGGTTT CGACACGA TCACGACACAT AAATTG GCGGACTTG AATAGC
5000. CGGACTTGAA TAGCCCA AAGGTTTCGA CACGATCAC GACACA TAAATTGGCGG ACTTGAAT AGC</code></pre></div></div><h4><a class="nav-anchor" id="Subsampling-molecules-from-a-pool-1" href="#Subsampling-molecules-from-a-pool-1">Subsampling molecules from a pool</a></h4><p>DNA sequencing experiments are sampling processes, not every one of the  DNA molecules in a pool will be read by the sequencer.</p><p>Randomly subsampling (without replacement) DNA molecules of a pool is achieved in <code>Pseudoseq</code> with the <a href="../api/pool/#Pseudoseq.subsample-Tuple{Pseudoseq.MoleculePool,Int64}"><code>subsample</code></a> function.</p><h5><a class="nav-anchor" id="Determining-the-number-of-molecules-to-subsample-1" href="#Determining-the-number-of-molecules-to-subsample-1">Determining the number of molecules to subsample</a></h5><p>You can estimate how often a base position in the genome is represented in a DNA molecule pool using the following formula.</p><div>\[C = \frac{LN}{G}\]</div><p>Where <span>$C$</span> is the expected coverage, <span>$L$</span> is the average length of the fragments, and <span>$N$</span> is the number of fragments, and <span>$G$</span> is the number of bases in the genome.</p><p>If you wanted to subsample a pool such that each base position in a genome is represented ~50 times (i.e. to achieve 50x coverage), you can determine the number of fragments to subsample from the universe, by reversing the formula:</p><div>\[N = \frac{CG}{L}\]</div><p>For example, if you wanted to sequence 250bp paired-end reads, at 50x coverage, with a genome size of 4639675bp:</p><div>\[\frac{50 \times 4639675}{250} = 927935\]</div><p>Remembering that you get two reads from one DNA molecule with paired-end sequencing, you know to subsample <span>$927935 / 2 = 463967$</span> DNA molecules from a pool.</p><div class="admonition tip"><div class="admonition-title">Tip</div><div class="admonition-text"><p>Pseudoseq provides a helper function that assists in this type of calculation:</p><pre><code class="language-julia">genome_size = 4639675
expected_coverage = 50
read_length = 250

N = needed_sample_size(expected_coverage, genome_size, readlength)

# Divide by 2 as we&#39;re doing paired end sequencing.
div(N, 2)</code></pre></div></div><h4><a class="nav-anchor" id="Tagging-molecules-in-a-pool-1" href="#Tagging-molecules-in-a-pool-1">Tagging molecules in a pool</a></h4><p>Some DNA sequencing technologies work by allowing short reads to contain longer range information by tagging molecules in a pool. The basic idea being that if two short reads come from the same large DNA molecule, they will have the same tag.</p><p>If a DNA fragment in a universe is tagged, and then it is subsequently fragmented during a <a href="../api/pool/#Pseudoseq.fragment-Tuple{Pseudoseq.MoleculePool,Int64}"><code>fragment</code></a> transform, then all the smaller fragments derived from that long fragment will inherit that long fragment&#39;s tag. This allows shorter fragments to possess longer range information in the form of these tags, and this is the basis of 10x sequencing and similar technologies.</p><p><code>Pseudoseq</code> lets you attach tags to molecules in a pool using the <a href="../api/pool/#Pseudoseq.tag-Tuple{Pseudoseq.MoleculePool,Int64}"><code>tag</code></a> function.</p><h3><a class="nav-anchor" id=".-Generating-reads-1" href="#.-Generating-reads-1">3. Generating reads</a></h3><p>Next, you generate a set of reads from your transformed pool.  <code>Pseudoseq</code> allows you to create paired-end sequencing reads, single-end sequencing reads, and linked paired-end sequencing reads.</p><p>You create a set of reads using the <a href="../api/reads/#Pseudoseq.make_reads"><code>make_reads</code></a> function.</p><p>All sequencers have a certain error rate, and so after you&#39;ve created a set of reads, you can use the <a href="../api/reads/#Pseudoseq.mark_errors"><code>mark_errors</code></a> function to randomly mark a set of bases in your reads that are destined to be errors in the output file.</p><p>Finally, you use your set of reads to <a href="../api/reads/#Pseudoseq.generate"><code>generate</code></a> either an interleaved FASTQ file, or two FASTQ files (one for R1 reads, and one for R2 reads).</p><footer><hr/><a class="previous" href="../examples/build-a-yeast/"><span class="direction">Previous</span><span class="title">Build-a-Yeast</span></a><a class="next" href="../examples/pe-example/"><span class="direction">Next</span><span class="title">Paired end reads</span></a></footer></article></body></html>
