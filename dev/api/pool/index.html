<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Molecule Pool · Pseudoseq.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../index.html"><img class="logo" src="../../assets/logo.png" alt="Pseudoseq.jl logo"/></a><h1>Pseudoseq.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Build-a-Genome</span><ul><li><a class="toctext" href="../../build-a-genome/">Core concepts &amp; workflow</a></li><li><span class="toctext">Examples</span></li></ul></li><li><span class="toctext">Sequencing</span><ul><li><a class="toctext" href="../../sequencing/">Core concepts &amp; workflow</a></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../examples/pe-example/">Paired end reads</a></li><li><a class="toctext" href="../../examples/se-example/">Long single end reads</a></li><li><a class="toctext" href="../../examples/tg-example/">Tagged paired end reads</a></li></ul></li></ul></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="../sequence/">Sequencing</a></li><li class="current"><a class="toctext" href>Molecule Pool</a><ul class="internal"><li><a class="toctext" href="#Exported-functions-1">Exported functions</a></li></ul></li><li><a class="toctext" href="../reads/">Reads</a></li><li><a class="toctext" href="../chromosome-blueprint/">Chromosome Blueprint</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>API</li><li><a href>Molecule Pool</a></li></ul><a class="edit-page" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/master/docs/src/api/pool.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Molecule Pool</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="API:-MoleculePool-1" href="#API:-MoleculePool-1">API: MoleculePool</a></h1><h2><a class="nav-anchor" id="Exported-functions-1" href="#Exported-functions-1">Exported functions</a></h2><h3><a class="nav-anchor" id="Making-a-pool-of-molecules-1" href="#Making-a-pool-of-molecules-1">Making a pool of molecules</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Pseudoseq.makepool" href="#Pseudoseq.makepool"><code>Pseudoseq.makepool</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">makepool(gen::Vector{BioSequence{DNAAlphabet{2}}}, ng::Int = 1, iscircular::Bool = false)</code></pre><p>Create a pool of <code>ng</code> copies of a genome defined by the <code>gen</code> vector of sequences.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The argument <code>iscircular</code> is currently not used.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/cbee663ce98cad89d6c2e5d3c013377108601fb8/src/pool.jl#L7-L14">source</a><div><div><pre><code class="language-none">makepool(rdr::FASTA.Reader, ng::Int = 1, iscircular::Bool = false)</code></pre><p>Create a pool of <code>ng</code> copies of the genome read in from the <code>FASTA.Reader</code>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The argument <code>iscircular</code> is currently not used.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/cbee663ce98cad89d6c2e5d3c013377108601fb8/src/pool.jl#L26-L33">source</a><div><div><pre><code class="language-none">makepool(file::String, ng::Int, iscircular::Bool = false)</code></pre><p>Create a pool of <code>ng</code> copies of the genome in the fasta formatted <code>file</code>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The argument <code>iscircular</code> is currently not used.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/cbee663ce98cad89d6c2e5d3c013377108601fb8/src/pool.jl#L44-L51">source</a></section><h3><a class="nav-anchor" id="Molecule-pool-transformations-1" href="#Molecule-pool-transformations-1">Molecule pool transformations</a></h3><h4><a class="nav-anchor" id="Fragment-1" href="#Fragment-1">Fragment</a></h4><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Pseudoseq.fragment-Tuple{Pseudoseq.MoleculePool,Int64}" href="#Pseudoseq.fragment-Tuple{Pseudoseq.MoleculePool,Int64}"><code>Pseudoseq.fragment</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">fragment(p::MoleculePool, meansize::Int)</code></pre><p>Create a new pool by breaking up the DNA fragments in an input pool.</p><p>This method breaks up a DNA molecule in a pool <code>p</code>, such that the average length of the fragments is approximately <code>meansize</code>.</p><p>It fragments a molecule by scattering an appropriate number of breakpoints across the molecule, before cutting the molecule at those breakpoints.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Breakpoints are scattered entirely at random across a molecule. No two or more breakpoints can fall in exactly the same place, as those positions are sampled without replacement.</p></div></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The appropriate number of breakpoints to scatter across a molecule is calculated as:</p><div>\[\frac{L}{S} - 1\]</div><p>Where <span>$L$</span> is the length of the molecule being fragmented, and <span>$S$</span> is the desired expected fragment size. This calculation assumes breakpoints fall randomly across the molecule (see above note).</p></div></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>If a DNA molecule being fragmented is smaller than the desired <code>meansize</code>, then it will not be broken, it will simply be included in the new pool.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/cbee663ce98cad89d6c2e5d3c013377108601fb8/src/pool.jl#L86-L118">source</a></section><h4><a class="nav-anchor" id="Subsampling-1" href="#Subsampling-1">Subsampling</a></h4><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Pseudoseq.subsample-Tuple{Pseudoseq.MoleculePool,Int64}" href="#Pseudoseq.subsample-Tuple{Pseudoseq.MoleculePool,Int64}"><code>Pseudoseq.subsample</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">subsample(p::MoleculePool, n::Int)</code></pre><p>Create a new pool by sampling an input pool.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>DNA molecules in the input pool <code>p</code> are selected according to the uniform distribution; no one molecule is more or less likely to be selected than another.</p></div></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Sampling is done without replacement, so it is impossible for the new pool that is created to recieve one molecule the input pool twice.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/cbee663ce98cad89d6c2e5d3c013377108601fb8/src/pool.jl#L124-L137">source</a></section><h4><a class="nav-anchor" id="Tagging-1" href="#Tagging-1">Tagging</a></h4><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Pseudoseq.tag-Tuple{Pseudoseq.MoleculePool,Int64}" href="#Pseudoseq.tag-Tuple{Pseudoseq.MoleculePool,Int64}"><code>Pseudoseq.tag</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">tag(u::MoleculePool, ntags::Int)</code></pre><p>Create a pool of tagged DNA molecules from some input pool.</p><p>The new tagged pool has the same DNA molecules as the input pool. However, each DNA molecule in the new tagged pool will be assigned a tag in the range of <code>1:ntags</code>.</p><p>For any tagged molecules in a pool, any other molecules that are derived from that tagged molecule will inherit the same tag. For example, if a DNA fragment in a pool is tagged, and then it is subsequently fragmented during a <a href="#Pseudoseq.fragment-Tuple{Pseudoseq.MoleculePool,Int64}"><code>fragment</code></a> transform, then all the smaller fragments derived from that long fragment will inherit that long fragment&#39;s tag.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Which fragment gets a certain tag is completely random. It is possible for two distinct DNA molecules in a pool to be assigned the same tag. The likelihood of that happening depends on the size of the tag pool (<code>ntags</code>), and the number of fragments in the pool.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/bioinfologics/Pseudoseq.jl/blob/cbee663ce98cad89d6c2e5d3c013377108601fb8/src/pool.jl#L143-L164">source</a></section><footer><hr/><a class="previous" href="../sequence/"><span class="direction">Previous</span><span class="title">Sequencing</span></a><a class="next" href="../reads/"><span class="direction">Next</span><span class="title">Reads</span></a></footer></article></body></html>
